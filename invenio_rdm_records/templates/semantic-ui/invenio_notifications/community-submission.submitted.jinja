{# notifications/community-submission.submitted.jinja #}

{% block ctx_setup %}
    {% set submission_request = notification.context["request"] %}
    {%- set dummy = ctx.update({
        "submission_request": submission_request,
        "community": submission_request["receiver"],
        "creator": submission_request["created_by"],
        "record": submission_request["topic"],
        })
    %}
{% endblock ctx_setup %}

{%- block subject -%}
    New record submission for your community {{ ctx["community"]["metadata"]["title"] }} submitted by {{ ctx["creator"]["username"] }}
{%- endblock subject -%}

{%- block html_body -%}
<p>The record "{{ ctx["record"]["metadata"]["title"] }}" was submitted to your community {{ ctx["community"]["metadata"]["title"] }} by {{ ctx["creator"]["username"] }}.</p>

<a href="{{ ctx["submission_request"]["links"]["self_html"] }}" class="button">Review the submission_request</a>
{%- endblock html_body -%}

{%- block plain_body -%}
The record {{ ctx["record"]["metadata"]["title"] }} was submitted to your community {{ ctx["community"]["metadata"]["title"] }} by {{ ctx["creator"]["username"] }}.

Review the submission_request: {{ ctx["submission_request"]["links"]["self_html"] }}
{%- endblock plain_body -%}

{# Markdown for Slack/Mattermost/chat #}
{%- block md_body -%}
The record *{{ ctx["record"]["metadata"]["title"] }}* was submitted to your community *{{ ctx["community"]["metadata"]["title"] }}* by *{{ ctx["creator"]["username"] }}*.

[Review the submission_request]({{ ctx["submission_request"]["links"]["self_html"] }})
{%- endblock md_body -%}
